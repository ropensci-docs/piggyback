<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="piggyback">
<title>Piggyback Data atop your GitHub Repository! • piggyback</title>
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://docs.ropensci.org/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Piggyback Data atop your GitHub Repository!">
<meta property="og:description" content="piggyback">
<meta property="og:image" content="https://docs.ropensci.org/piggyback/logo.svg">
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Matomo --><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css">
<script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript>
<!-- End Matomo Code -->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="../index.html">piggyback</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.5.9004</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="active nav-item">
  <a class="nav-link" href="../articles/piggyback.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/alternatives.html">Piggyback comparison to alternatives</a>
    <a class="dropdown-item" href="../articles/cloud_native.html">Cloud native workflows with piggyback</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ropensci/piggyback/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Piggyback Data atop your GitHub Repository!</h1>
                        <h4 data-toc-skip class="author">Carl Boettiger &amp; Tan Ho</h4>
            
            <h4 data-toc-skip class="date">2023-12-26</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/piggyback/blob/HEAD/vignettes/piggyback.Rmd" class="external-link"><code>vignettes/piggyback.Rmd</code></a></small>
      <div class="d-none name"><code>piggyback.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/piggyback/">piggyback</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="why-piggyback">Why <code>piggyback</code>?<a class="anchor" aria-label="anchor" href="#why-piggyback"></a>
</h2>
<p><code>piggyback</code> grew out of the needs of students both in my classroom and in my research group, who frequently need to work with data files somewhat larger than one can conveniently manage by committing directly to GitHub. As we frequently want to share and run code that depends on &gt;50MB data files on each of our own machines, on continuous integration, and on larger computational servers, data sharing quickly becomes a bottleneck.</p>
<p><a href="https://docs.github.com/en/github/managing-large-files/distributing-large-binaries" class="external-link">GitHub allows</a> repositories to attach files of up to 2 GB each to releases as a way to distribute large files associated with the project source code. There is no limit on the number of files or bandwidth to deliver them.</p>
</div>
<div class="section level2">
<h2 id="authentication">Authentication<a class="anchor" aria-label="anchor" href="#authentication"></a>
</h2>
<p>No authentication is required to download data from <em>public</em> GitHub repositories using <code>piggyback</code>. Nevertheless, we recommends setting a token when possible to avoid rate limits. To upload data to any repository, or to download data from <em>private</em> repositories, you will need to authenticate first.</p>
<p><code>piggyback</code> uses the same GitHub Personal Access Token (PAT) that devtools, usethis, and friends use (<code><a href="https://gh.r-lib.org/reference/gh_token.html" class="external-link">gh::gh_token()</a></code>). The current best practice for managing your GitHub credentials is detailed in this <a href="https://usethis.r-lib.org/articles/git-credentials.html" class="external-link">usethis vignette</a>.</p>
<p>You can also add the token as an environment variable, which may be useful in situations where you use piggyback non-interactively (i.e. automated scripts). Here are the relevant steps:</p>
<ul>
<li>Create a <a href="https://github.com/settings/tokens/new?scopes=repo,gist&amp;description=PIGGYBACK_PAT" class="external-link">GitHub Token</a>
</li>
<li>Add the environment variable:
<ul>
<li>via project-specific Renviron:
<ul>
<li>
<code>usethis::use_git_ignore(".Renviron")</code> to update your gitignore - this prevents accidentally committing your token to GitHub</li>
<li>
<code>usethis::edit_r_environ("project")</code> to open the Renviron file, and then add your token, e.g. <code>GITHUB_PAT=ghp_a1b2c3d4e5f6g7</code>
</li>
</ul>
</li>
<li>via <code>Sys.setenv(GITHUB_PAT = "ghp_a1b2c3d4e5f6g7")</code> in your console for adhoc usage. Avoid adding this line to your R scripts – remember, the goal here is to avoid writing your private token in any file that might be shared, even privately.</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="download-files">Download Files<a class="anchor" aria-label="anchor" href="#download-files"></a>
</h2>
<p>Download a file from a release:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pb_download.html">pb_download</a></span><span class="op">(</span></span>
<span>  file <span class="op">=</span> <span class="st">"iris2.tsv.gz"</span>, </span>
<span>  dest <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  repo <span class="op">=</span> <span class="st">"cboettig/piggyback-tests"</span>,</span>
<span>  tag <span class="op">=</span> <span class="st">"v0.0.1"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; ℹ Downloading "iris2.tsv.gz"...</span></span>
<span><span class="co">#&gt;   |======================================================| 100%</span></span>
<span><span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/dir_tree.html" class="external-link">dir_tree</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; /tmp/RtmpWxJSZj</span></span>
<span><span class="co">#&gt; └── iris2.tsv.gz</span></span></code></pre></div>
<p>Some default behaviors to know about:</p>
<ol style="list-style-type: decimal">
<li>The <code>repo</code> argument in most piggyback functions will default to detecting the relevant GitHub repo based on your current working directory’s git configs, so in many cases you can omit the <code>repo</code> argument.</li>
<li>The <code>tag</code> argument in most functions defaults to “latest”, which typically refers to the most recently created release of the repository, unless there is a release specifically named “latest” or if you have marked a different release as “latest” via the GitHub UI.</li>
<li>The <code>dest</code> argument defaults to your current working directory (<code>"."</code>). We use <code><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir()</a></code> to meet CRAN policies for the purposes of examples.</li>
<li>The <code>file</code> argument in <code>pb_download</code> defaults to NULL, which will download all files connected to a given release:</li>
</ol>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pb_download.html">pb_download</a></span><span class="op">(</span></span>
<span>  repo <span class="op">=</span> <span class="st">"cboettig/piggyback-tests"</span>,</span>
<span>  tag <span class="op">=</span> <span class="st">"v0.0.1"</span>,</span>
<span>  dest <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; ℹ Downloading "diamonds.tsv.gz"...</span></span>
<span><span class="co">#&gt;   |======================================================| 100%</span></span>
<span><span class="co">#&gt; ℹ Downloading "iris.tsv.gz"...</span></span>
<span><span class="co">#&gt;   |======================================================| 100%</span></span>
<span><span class="co">#&gt; ℹ Downloading "iris.tsv.xz"...</span></span>
<span><span class="co">#&gt;   |======================================================| 100%</span></span>
<span><span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/dir_tree.html" class="external-link">dir_tree</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; /tmp/RtmpWxJSZj</span></span>
<span><span class="co">#&gt; ├── diamonds.tsv.gz</span></span>
<span><span class="co">#&gt; ├── iris.tsv.gz</span></span>
<span><span class="co">#&gt; ├── iris.tsv.xz</span></span>
<span><span class="co">#&gt; └── iris2.tsv.gz</span></span></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li>The <code>use_timestamps</code> argument defaults to TRUE - notice that above, <code>iris2.tsv.gz</code> was not downloaded. If <code>use_timestamps</code> is TRUE, pb_download() will compare the local file timestamp against the GitHub file timestamp, and only download the file if it has changed.</li>
</ol>
<p><code><a href="../reference/pb_download.html">pb_download()</a></code> also includes arguments to control the progress bar or if any particular files should not be downloaded.</p>
<div class="section level3">
<h3 id="download-urls">Download URLs<a class="anchor" aria-label="anchor" href="#download-urls"></a>
</h3>
<p>Sometimes it is preferable to have a URL from which the data can be read in directly. These URL can then be passed into another R function, which can be more elegant and performant than having to first download the files locally. Enter <code><a href="../reference/pb_download_url.html">pb_download_url()</a></code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pb_download_url.html">pb_download_url</a></span><span class="op">(</span>repo <span class="op">=</span> <span class="st">"cboettig/piggyback-tests"</span>, tag <span class="op">=</span> <span class="st">"v0.0.1"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "https://github.com/cboettig/piggyback-tests/releases/download/v0.0.1/diamonds.tsv.gz"</span></span>
<span><span class="co">#&gt; [2] "https://github.com/cboettig/piggyback-tests/releases/download/v0.0.1/iris.tsv.gz"    </span></span>
<span><span class="co">#&gt; [3] "https://github.com/cboettig/piggyback-tests/releases/download/v0.0.1/iris.tsv.xz"    </span></span>
<span><span class="co">#&gt; [4] "https://github.com/cboettig/piggyback-tests/releases/download/v0.0.1/iris2.tsv.gz" </span></span></code></pre></div>
<p>By default, this function returns the same download URL that you would get by visiting the release page, right-clicking on the file, and copying the link (aka the “browser_download_url”). This URL is served by GitHub’s web servers and not its API servers, and therefore not as restrictive with rate-limiting.</p>
<p>However, this URL is not accessible for private repositories, since the auth tokens are handled by the GitHub API. You can retrieve the API download url for private repositories by passing in <code>"api"</code> to the <code>url_type</code> argument:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pb_download_url.html">pb_download_url</a></span><span class="op">(</span>repo <span class="op">=</span> <span class="st">"cboettig/piggyback-tests"</span>, tag <span class="op">=</span> <span class="st">"v0.0.1"</span>, url_type <span class="op">=</span> <span class="st">"api"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] https://api.github.com/repos/cboettig/piggyback-tests/releases/assets/44261315</span></span>
<span><span class="co">#&gt; [2] https://api.github.com/repos/cboettig/piggyback-tests/releases/assets/41841778</span></span>
<span><span class="co">#&gt; [3] https://api.github.com/repos/cboettig/piggyback-tests/releases/assets/18538636</span></span>
<span><span class="co">#&gt; [4] https://api.github.com/repos/cboettig/piggyback-tests/releases/assets/8990141</span></span></code></pre></div>
<p><code>pb_download_url</code> otherwise shares similar default behaviors with <code>pb_download</code> for the <code>file</code>, <code>repo</code>, and <code>tag</code> arguments.</p>
</div>
</div>
<div class="section level2">
<h2 id="reading-data-for-r-usage">Reading data for R usage<a class="anchor" aria-label="anchor" href="#reading-data-for-r-usage"></a>
</h2>
<p><code>piggyback</code> supports several general patterns for reading data into R, with increasing degrees of performance/efficiency (and complexity):</p>
<ul>
<li>
<code><a href="../reference/pb_download.html">pb_download()</a></code> files to disk and then reading files with a function that reads from disk into memory</li>
<li>
<code><a href="../reference/pb_download_url.html">pb_download_url()</a></code> a set of URLs and then passing those URLs to a function that retrieves those URLs directly into memory</li>
<li>Disk-based workflows which require downloading all files first but then can perform queries before reading into memory</li>
<li>Cloud-native workflows which can perform queries directly on the URLs before reading into memory</li>
</ul>
<p>We recommend the latter two approaches in cases where performance and efficiency matter, and have some vignettes with examples: - <a href="https://docs.ropensci.org/piggyback/articles/cloud_native.html">cloud native workflows</a> - disk native workflows</p>
<div class="section level3">
<h3 id="reading-files">Reading files<a class="anchor" aria-label="anchor" href="#reading-files"></a>
</h3>
<p><code><a href="../reference/pb_read.html">pb_read()</a></code> is a wrapper on the first pattern - it downloads the file to a temp file, then reads that file into memory, then deletes the temporary file. It works for both public and private repositories, handling authentication under the hood:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pb_read.html">pb_read</a></span><span class="op">(</span><span class="st">"mtcars.rds"</span>, repo <span class="op">=</span> <span class="st">"tanho63/piggyback-private"</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A data.frame: 32 × 11</span></span>
<span><span class="co">#&gt;     mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb</span></span>
<span><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1  21       6   160   110  3.9   2.62  16.5     0     1     4     4</span></span>
<span><span class="co">#&gt; 2  21       6   160   110  3.9   2.88  17.0     0     1     4     4</span></span>
<span><span class="co">#&gt; 3  22.8     4   108    93  3.85  2.32  18.6     1     1     4     1</span></span>
<span><span class="co">#&gt; 4  21.4     6   258   110  3.08  3.22  19.4     1     0     3     1</span></span>
<span><span class="co">#&gt; 5  18.7     8   360   175  3.15  3.44  17.0     0     0     3     2</span></span>
<span><span class="co">#&gt; # ℹ 27 more rows</span></span>
<span><span class="co">#&gt; # ℹ 1 more variable: carb &lt;dbl&gt;</span></span>
<span><span class="fu"><a href="../reference/pb_read.html">pb_read</a></span><span class="op">(</span><span class="st">"mtcars.parquet"</span>, repo <span class="op">=</span> <span class="st">"tanho63/piggyback-private"</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A data.frame: 32 × 11</span></span>
<span><span class="co">#&gt;     mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb</span></span>
<span><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1  21       6   160   110  3.9   2.62  16.5     0     1     4     4</span></span>
<span><span class="co">#&gt; 2  21       6   160   110  3.9   2.88  17.0     0     1     4     4</span></span>
<span><span class="co">#&gt; 3  22.8     4   108    93  3.85  2.32  18.6     1     1     4     1</span></span>
<span><span class="co">#&gt; 4  21.4     6   258   110  3.08  3.22  19.4     1     0     3     1</span></span>
<span><span class="co">#&gt; 5  18.7     8   360   175  3.15  3.44  17.0     0     0     3     2</span></span>
<span><span class="co">#&gt; # ℹ 27 more rows</span></span>
<span><span class="co">#&gt; # ℹ 1 more variable: carb &lt;dbl&gt;</span></span></code></pre></div>
<p>By default, <code>pb_read</code> is programmed to use the following <code>read_function</code> for the corresponding file extensions:</p>
<ul>
<li>“.csv”, “.csv.gz”, “.csv.xz” are read with <code><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">utils::read.csv()</a></code>
</li>
<li>“.tsv”, “.tsv.gz”, “.tsv.xz” are read with <code><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">utils::read.delim()</a></code>
</li>
<li>“.rds” is read with <code><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS()</a></code>
</li>
<li>“.json” is read with <code><a href="https://rdrr.io/pkg/jsonlite/man/fromJSON.html" class="external-link">jsonlite::fromJSON()</a></code>
</li>
<li>“.parquet” is read with <code><a href="https://arrow.apache.org/docs/r/reference/read_parquet.html" class="external-link">arrow::read_parquet()</a></code>
</li>
<li>“.txt” is read with <code><a href="https://rdrr.io/r/base/readLines.html" class="external-link">readLines()</a></code>
</li>
</ul>
<p>If a file extension is not on this list, <code>pb_read</code> will raise an error and ask you to provide a <code>read_function</code> - you can also use this parameter to override the default <code>read_function</code> yourself:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pb_read.html">pb_read</a></span><span class="op">(</span></span>
<span>  file <span class="op">=</span> <span class="st">"play_by_play_2023.qs"</span>, </span>
<span>  repo <span class="op">=</span> <span class="st">"nflverse/nflverse-data"</span>,</span>
<span>  tag <span class="op">=</span> <span class="st">"pbp"</span>,</span>
<span>  read_function <span class="op">=</span> <span class="fu">qs</span><span class="fu">::</span><span class="va">qread</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 42,251 × 372</span></span>
<span><span class="co">#&gt;   play_id game_id        old_game_id home_team away_team season_type  week posteam</span></span>
<span><span class="co">#&gt;     &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt;       &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;  </span></span>
<span><span class="co">#&gt; 1       1 2023_01_ARI_W… 2023091007  WAS       ARI       REG             1 NA     </span></span>
<span><span class="co">#&gt; 2      39 2023_01_ARI_W… 2023091007  WAS       ARI       REG             1 WAS    </span></span>
<span><span class="co">#&gt; 3      55 2023_01_ARI_W… 2023091007  WAS       ARI       REG             1 WAS    </span></span>
<span><span class="co">#&gt; 4      77 2023_01_ARI_W… 2023091007  WAS       ARI       REG             1 WAS    </span></span>
<span><span class="co">#&gt; 5     102 2023_01_ARI_W… 2023091007  WAS       ARI       REG             1 WAS    </span></span>
<span><span class="co">#&gt; # ℹ 42,246 more rows</span></span>
<span><span class="co">#&gt; # ℹ 364 more variables: posteam_type &lt;chr&gt;, defteam &lt;chr&gt;, side_of_field &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   yardline_100 &lt;dbl&gt;, game_date &lt;chr&gt;, quarter_seconds_remaining &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   half_seconds_remaining &lt;dbl&gt;, game_seconds_remaining &lt;dbl&gt;, game_half &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   quarter_end &lt;dbl&gt;, drive &lt;dbl&gt;, sp &lt;dbl&gt;, qtr &lt;dbl&gt;, down &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   goal_to_go &lt;dbl&gt;, time &lt;chr&gt;, yrdln &lt;chr&gt;, ydstogo &lt;dbl&gt;, ydsnet &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   desc &lt;chr&gt;, play_type &lt;chr&gt;, yards_gained &lt;dbl&gt;, shotgun &lt;dbl&gt;, …</span></span></code></pre></div>
<p>Any <code>read_function</code> can be provided so long as it accepts the filename as the first argument, and you can pass any additional parameters via <code>...</code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pb_read.html">pb_read</a></span><span class="op">(</span></span>
<span>  file <span class="op">=</span> <span class="st">"play_by_play_2023.csv"</span>, </span>
<span>  n_max <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  repo <span class="op">=</span> <span class="st">"nflverse/nflverse-data"</span>,</span>
<span>  tag <span class="op">=</span> <span class="st">"pbp"</span>,</span>
<span>  read_function <span class="op">=</span> <span class="fu">readr</span><span class="fu">::</span><span class="va"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 10 × 372</span></span>
<span><span class="co">#&gt;   play_id game_id        old_game_id home_team away_team season_type  week posteam</span></span>
<span><span class="co">#&gt;     &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt;       &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;  </span></span>
<span><span class="co">#&gt; 1       1 2023_01_ARI_W… 2023091007  WAS       ARI       REG             1 NA     </span></span>
<span><span class="co">#&gt; 2      39 2023_01_ARI_W… 2023091007  WAS       ARI       REG             1 WAS    </span></span>
<span><span class="co">#&gt; 3      55 2023_01_ARI_W… 2023091007  WAS       ARI       REG             1 WAS    </span></span>
<span><span class="co">#&gt; 4      77 2023_01_ARI_W… 2023091007  WAS       ARI       REG             1 WAS    </span></span>
<span><span class="co">#&gt; 5     102 2023_01_ARI_W… 2023091007  WAS       ARI       REG             1 WAS    </span></span>
<span><span class="co">#&gt; # ℹ 5 more rows</span></span>
<span><span class="co">#&gt; # ℹ 364 more variables: posteam_type &lt;chr&gt;, defteam &lt;chr&gt;, side_of_field &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   yardline_100 &lt;dbl&gt;, game_date &lt;chr&gt;, quarter_seconds_remaining &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   half_seconds_remaining &lt;dbl&gt;, game_seconds_remaining &lt;dbl&gt;, game_half &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   quarter_end &lt;dbl&gt;, drive &lt;dbl&gt;, sp &lt;dbl&gt;, qtr &lt;dbl&gt;, down &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   goal_to_go &lt;dbl&gt;, time &lt;chr&gt;, yrdln &lt;chr&gt;, ydstogo &lt;dbl&gt;, ydsnet &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   desc &lt;chr&gt;, play_type &lt;chr&gt;, yards_gained &lt;dbl&gt;, shotgun &lt;dbl&gt;, …</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="reading-from-urls">Reading from URLs<a class="anchor" aria-label="anchor" href="#reading-from-urls"></a>
</h3>
<p>More efficiently, many read functions accept URLs, including <code><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv()</a></code>, <code><a href="https://arrow.apache.org/docs/r/reference/read_parquet.html" class="external-link">arrow::read_parquet()</a></code>, <code><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">readr::read_csv()</a></code>, <code>data.table::fread()</code>, and <code><a href="https://rdrr.io/pkg/jsonlite/man/fromJSON.html" class="external-link">jsonlite::fromJSON()</a></code>, so reading in one file can be done by passing along the output of <code><a href="../reference/pb_download_url.html">pb_download_url()</a></code>:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pb_download_url.html">pb_download_url</a></span><span class="op">(</span><span class="st">"mtcars.csv"</span>, repo <span class="op">=</span> <span class="st">"tanho63/piggyback-tests"</span>, tag <span class="op">=</span> <span class="st">"v0.0.2"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A data.frame: 32 × 12</span></span>
<span><span class="co">#&gt;   X        mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;  &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1 Mazda…  21       6   160   110  3.9   2.62  16.5     0     1     4</span></span>
<span><span class="co">#&gt; 2 Mazda…  21       6   160   110  3.9   2.88  17.0     0     1     4</span></span>
<span><span class="co">#&gt; 3 Datsu…  22.8     4   108    93  3.85  2.32  18.6     1     1     4</span></span>
<span><span class="co">#&gt; 4 Horne…  21.4     6   258   110  3.08  3.22  19.4     1     0     3</span></span>
<span><span class="co">#&gt; 5 Horne…  18.7     8   360   175  3.15  3.44  17.0     0     0     3</span></span>
<span><span class="co">#&gt; # ℹ 27 more rows</span></span>
<span><span class="co">#&gt; # ℹ 1 more variable: carb &lt;int&gt;</span></span>
<span><span class="co">#&gt; # ℹ Use `print(n = ...)` to see more rows</span></span></code></pre></div>
<p>Some functions also accept URLs when converted into a connection by wrapping it in <code><a href="https://rdrr.io/r/base/connections.html" class="external-link">url()</a></code>, e.g. for <code><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS()</a></code>:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pb_url</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pb_download_url.html">pb_download_url</a></span><span class="op">(</span><span class="st">"mtcars.rds"</span>, repo <span class="op">=</span> <span class="st">"tanho63/piggyback-tests"</span>, tag <span class="op">=</span> <span class="st">"v0.0.2"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/connections.html" class="external-link">url</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="va">pb_url</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A data.frame: 32 × 11</span></span>
<span><span class="co">#&gt;     mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb</span></span>
<span><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1  21       6   160   110  3.9   2.62  16.5     0     1     4     4</span></span>
<span><span class="co">#&gt; 2  21       6   160   110  3.9   2.88  17.0     0     1     4     4</span></span>
<span><span class="co">#&gt; 3  22.8     4   108    93  3.85  2.32  18.6     1     1     4     1</span></span>
<span><span class="co">#&gt; 4  21.4     6   258   110  3.08  3.22  19.4     1     0     3     1</span></span>
<span><span class="co">#&gt; 5  18.7     8   360   175  3.15  3.44  17.0     0     0     3     2</span></span>
<span><span class="co">#&gt; # ℹ 27 more rows</span></span>
<span><span class="co">#&gt; # ℹ Use `print(n = ...)` to see more rows</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/connections.html" class="external-link">close</a></span><span class="op">(</span><span class="va">pb_url</span><span class="op">)</span></span></code></pre></div>
<p>Note that using <code><a href="https://rdrr.io/r/base/connections.html" class="external-link">url()</a></code> requires that we close the connection after reading it, or else we will receive warnings about leaving open connections.</p>
<p>This <code><a href="https://rdrr.io/r/base/connections.html" class="external-link">url()</a></code> approach allows us to pass along authentication for private repos, e.g.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pb_url</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pb_download_url.html">pb_download_url</a></span><span class="op">(</span><span class="st">"mtcars.rds"</span>, repo <span class="op">=</span> <span class="st">"tanho63/piggyback-private"</span>, url_type <span class="op">=</span> <span class="st">"api"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/connections.html" class="external-link">url</a></span><span class="op">(</span></span>
<span>    headers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"Accept"</span> <span class="op">=</span> <span class="st">"application/octet-stream"</span>,</span>
<span>      <span class="st">"Authorization"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Bearer"</span>, <span class="fu">gh</span><span class="fu">::</span><span class="fu"><a href="https://gh.r-lib.org/reference/gh_token.html" class="external-link">gh_token</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="va">pb_url</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 32 × 11</span></span>
<span><span class="co">#&gt;     mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb</span></span>
<span><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1  21       6   160   110  3.9   2.62  16.5     0     1     4     4</span></span>
<span><span class="co">#&gt; 2  21       6   160   110  3.9   2.88  17.0     0     1     4     4</span></span>
<span><span class="co">#&gt; 3  22.8     4   108    93  3.85  2.32  18.6     1     1     4     1</span></span>
<span><span class="co">#&gt; 4  21.4     6   258   110  3.08  3.22  19.4     1     0     3     1</span></span>
<span><span class="co">#&gt; 5  18.7     8   360   175  3.15  3.44  17.0     0     0     3     2</span></span>
<span><span class="co">#&gt; # ℹ 27 more rows</span></span>
<span><span class="co">#&gt; # ℹ Use `print(n = ...)` to see more rows</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/connections.html" class="external-link">close</a></span><span class="op">(</span><span class="va">pb_url</span><span class="op">)</span></span></code></pre></div>
<p>Note that <code>arrow</code> does not accept a <code><a href="https://rdrr.io/r/base/connections.html" class="external-link">url()</a></code> connection at this time, so you should default to <code><a href="../reference/pb_read.html">pb_read()</a></code> if using private repositories. <!-- update if we implement pb_read_url? --></p>
</div>
</div>
<div class="section level2">
<h2 id="uploading-data">Uploading data<a class="anchor" aria-label="anchor" href="#uploading-data"></a>
</h2>
<p><code>piggyback</code> uploads data to GitHub releases. If your repository doesn’t have a release yet, <code>piggyback</code> will prompt you to create one - you can create a release with:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pb_release_create.html">pb_release_create</a></span><span class="op">(</span>repo <span class="op">=</span> <span class="st">"cboettig/piggyback-tests"</span>, tag <span class="op">=</span> <span class="st">"v0.0.2"</span><span class="op">)</span></span>
<span><span class="co">#&gt; ✔ Created new release "v0.0.2".</span></span></code></pre></div>
<p>Create new releases to manage multiple versions of a given data file, or to organize sets of files under a common topic. While you can create releases as often as you like, making a new release is not necessary each time you upload a file. If maintaining old versions of the data is not useful, you can stick with a single release and upload all of your data there.</p>
<p>Once we have at least one release available, we are ready to upload files. By default, <code>pb_upload</code> will attach data to the latest release.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## We'll need some example data first.</span></span>
<span><span class="co">## Pro tip: compress your tabular data to save space &amp; speed upload/downloads</span></span>
<span><span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html" class="external-link">write_tsv</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="st">"mtcars.tsv.gz"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/pb_upload.html">pb_upload</a></span><span class="op">(</span><span class="st">"mtcars.tsv.gz"</span>, repo <span class="op">=</span> <span class="st">"cboettig/piggyback-tests"</span><span class="op">)</span></span>
<span><span class="co">#&gt; ℹ Uploading to latest release: "v0.0.2".</span></span>
<span><span class="co">#&gt; ℹ Uploading mtcars.tsv.gz ...</span></span>
<span><span class="co">#&gt;   |===================================================| 100%</span></span></code></pre></div>
<p>Like <code><a href="../reference/pb_download.html">pb_download()</a></code>, <code><a href="../reference/pb_upload.html">pb_upload()</a></code> will overwrite any file of the same name already attached to the release file by default, unless the timestamp of the previously uploaded version is more recent. You can toggle these settings with the <code>overwrite</code> parameter.</p>
<p><code>pb_upload</code> also accepts a vector of multiple files to upload:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span>
<span><span class="co">## upload a folder of data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="st">"data"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/pb_upload.html">pb_upload</a></span><span class="op">(</span>repo <span class="op">=</span> <span class="st">"cboettig/piggyback-tests"</span>, tag <span class="op">=</span> <span class="st">"v0.0.1"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## upload certain file extensions</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"*.tsv.gz"</span>, <span class="st">"*.tif"</span>, <span class="st">"*.zip"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/pb_upload.html">pb_upload</a></span><span class="op">(</span>repo <span class="op">=</span> <span class="st">"cboettig/piggyback-tests"</span>, tag <span class="op">=</span> <span class="st">"v0.0.1"</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="write-r-object-directly-to-release">Write R object directly to release<a class="anchor" aria-label="anchor" href="#write-r-object-directly-to-release"></a>
</h3>
<p><code>pb_write</code> wraps the above process, essentially allowing you to upload directly to a release by providing an object, filename, and repo/tag:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pb_write.html">pb_write</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="st">"mtcars.rds"</span>, repo <span class="op">=</span> <span class="st">"cboettig/piggyback-tests"</span><span class="op">)</span></span>
<span><span class="co">#&gt; ℹ Uploading to latest release: "v0.0.2".</span></span>
<span><span class="co">#&gt; ℹ Uploading mtcars.rds ...</span></span>
<span><span class="co">#&gt;   |===================================================| 100%</span></span></code></pre></div>
<p>Similar to <code>pb_read</code>, <code>pb_write</code> has some pre-programmed <code>write_functions</code> for the following file extensions: - “.csv”, “.csv.gz”, “.csv.xz” are written with <code><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">utils::write.csv()</a></code> - “.tsv”, “.tsv.gz”, “.tsv.xz” are written with <code>utils::write.csv(x, filename, sep = '\t')</code> - “.rds” is written with <code><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS()</a></code> - “.json” is written with <code><a href="https://rdrr.io/pkg/jsonlite/man/read_json.html" class="external-link">jsonlite::write_json()</a></code> - “.parquet” is written with <code><a href="https://arrow.apache.org/docs/r/reference/write_parquet.html" class="external-link">arrow::write_parquet()</a></code> - “.txt” is written with <code><a href="https://rdrr.io/r/base/writeLines.html" class="external-link">writeLines()</a></code></p>
<p>and you can pass custom functions with the <code>write_function</code> parameter:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pb_write.html">pb_write</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">mtcars</span>, </span>
<span>  file <span class="op">=</span> <span class="st">"mtcars.csv.gz"</span>, </span>
<span>  repo <span class="op">=</span> <span class="st">"cboettig/piggyback-tests"</span>, </span>
<span>  write_function <span class="op">=</span> <span class="fu">data.table</span><span class="fu">::</span><span class="va">fwrite</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; ℹ Uploading to latest release: "v0.0.2".</span></span>
<span><span class="co">#&gt; ℹ Uploading mtcars.csv.gz ...</span></span>
<span><span class="co">#&gt;   |===================================================| 100%</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="deleting-files">Deleting Files<a class="anchor" aria-label="anchor" href="#deleting-files"></a>
</h2>
<p>Delete a file from a release:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pb_delete.html">pb_delete</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"mtcars.tsv.gz"</span>, </span>
<span>          repo <span class="op">=</span> <span class="st">"cboettig/piggyback-tests"</span>, </span>
<span>          tag <span class="op">=</span> <span class="st">"v0.0.1"</span><span class="op">)</span></span>
<span><span class="co">#&gt; ℹ Deleted "mtcars.tsv.gz" from "v0.0.1" release on "cboettig/piggyback-tests"</span></span></code></pre></div>
<p>Note that this is irreversible unless you have a copy of the data elsewhere.</p>
</div>
<div class="section level2">
<h2 id="listing-files">Listing Files<a class="anchor" aria-label="anchor" href="#listing-files"></a>
</h2>
<p>List all files currently piggybacking on a given release. Omit <code>tag</code> to see files on all releases.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pb_list.html">pb_list</a></span><span class="op">(</span>repo <span class="op">=</span> <span class="st">"cboettig/piggyback-tests"</span>, tag <span class="op">=</span> <span class="st">"v0.0.1"</span><span class="op">)</span></span>
<span><span class="co">#&gt;         file_name   size           timestamp    tag    owner            repo</span></span>
<span><span class="co">#&gt; 1 diamonds.tsv.gz 571664 2021-09-07 23:38:31 v0.0.1 cboettig piggyback-tests</span></span>
<span><span class="co">#&gt; 2     iris.tsv.gz    846 2021-08-05 20:00:09 v0.0.1 cboettig piggyback-tests</span></span>
<span><span class="co">#&gt; 3     iris.tsv.xz    848 2020-03-07 06:18:32 v0.0.1 cboettig piggyback-tests</span></span>
<span><span class="co">#&gt; 4    iris2.tsv.gz    846 2018-10-05 17:04:33 v0.0.1 cboettig piggyback-tests</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="caching">Caching<a class="anchor" aria-label="anchor" href="#caching"></a>
</h2>
<p>To reduce GitHub API calls, piggyback caches <code>pb_releases</code> and <code>pb_list</code> with a timeout of 10 minutes by default. This avoids repeating identical requests to update its internal record of the repository data (releases, assets, timestamps, etc) during programmatic use. You can increase or decrease this delay by setting the environment variable in seconds, e.g. <code>Sys.setenv("piggyback_cache_duration" = 3600)</code> for a longer cache or <code>Sys.setenv("piggyback_cache_duration" = 0)</code> to disable caching, and then restarting R.</p>
</div>
<div class="section level2">
<h2 id="valid-file-names">Valid file names<a class="anchor" aria-label="anchor" href="#valid-file-names"></a>
</h2>
<p>GitHub assets attached to a release do not support file paths, and will sometimes convert most special characters (<code>#</code>, <code>%</code>, etc) to <code>.</code> or throw an error (e.g.  for file names containing <code>$</code>, <code>@</code>, <code>/</code>). <code>piggyback</code> will default to using the <code><a href="https://rdrr.io/r/base/basename.html" class="external-link">basename()</a></code> of the file only (i.e. will only use <code>"mtcars.csv"</code> if provided a file path like <code>"data/mtcars.csv"</code>)</p>
</div>
<div class="section level2">
<h2 id="a-note-on-github-releases-vs-data-archiving">A Note on GitHub Releases vs Data Archiving<a class="anchor" aria-label="anchor" href="#a-note-on-github-releases-vs-data-archiving"></a>
</h2>
<p><code>piggyback</code> is not intended as a data archiving solution. Importantly, bear in mind that there is nothing special about multiple “versions” in releases, as far as data assets uploaded by <code>piggyback</code> are concerned. The data files <code>piggyback</code> attaches to a Release can be deleted or modified at any time – creating a new release to store data assets is the functional equivalent of just creating new directories <code>v0.1</code>, <code>v0.2</code> to store your data. (GitHub Releases are always pinned to a particular <code>git</code> tag, so the code/git-managed contents associated with repo are more immutable, but remember our data assets just piggyback on top of the repo).</p>
<p>Permanent, published data should always be archived in a proper data repository with a DOI, such as <a href="https://zenodo.org" class="external-link">zenodo.org</a>. Zenodo can freely archive public research data files up to 50 GB in size, and data is strictly versioned (once released, a DOI always refers to the same version of the data, new releases are given new DOIs). <code>piggyback</code> is meant only to lower the friction of working with data during the research process, (e.g. provide data accessible to collaborators or continuous integration systems during research process, including for private repositories.)</p>
</div>
<div class="section level2">
<h2 id="what-will-github-think-of-this">What will GitHub think of this?<a class="anchor" aria-label="anchor" href="#what-will-github-think-of-this"></a>
</h2>
<p><a href="https://docs.github.com/en/github/managing-large-files/distributing-large-binaries" class="external-link">GitHub documentation</a> at the time of writing endorses the use of attachments to releases as a solution for distributing large files as part of your project:</p>
<p><img src="https://github.com/ropensci/piggyback/raw/83776863b34bb1c9962154608a5af41867a0622f/man/figures/github-policy.png" align="left" alt="screenshot of GitHub docs linked above" width="100%"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg">
</div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul>
</div>
                    <div class="col-md-3 col-sm-4">
                        <ul>
<h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul>
</div>
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul>
</div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer>
</div>

  

  

  </body>
</html>
